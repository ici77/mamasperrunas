<div class="container-fluid">
  <div class="row d-flex align-items-stretch">

    <!-- ğŸ“Œ MenÃº lateral izquierdo -->
<aside class="col-12 col-md-3 col-lg-2 sidebar-left">
  <h3>Eventos</h3>
  <ul class="list-group">
    <li class="list-group-item" *ngFor="let categoria of categorias">
      <a [routerLink]="['/eventos']" [queryParams]="{ tipo: categoria.tipo }">
        {{ categoria.nombre | uppercase }}
      </a>
    </li>
  </ul>

  <!-- ğŸ“Œ Tarjetas informativas -->
  <div class="info-card" *ngFor="let card of tarjetasInformativas">
    <h4>{{ card.titulo }}</h4>
    <img [src]="card.imagen" [alt]="card.titulo" />
    <p>{{ card.descripcion }}</p>
    <a [routerLink]="card.link" class="btn btn-secondary">{{ card.boton }}</a>
  </div>
</aside>


    <!-- ğŸ“Œ Zona principal de eventos -->
    <div class="col-12 col-md-9 col-lg-10 d-flex flex-column">

      <!-- Migas de pan -->
      <nav aria-label="breadcrumb" class="breadcrumb-container">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a routerLink="/">ğŸ  Inicio</a></li>
          <li class="breadcrumb-item active" aria-current="page">Eventos</li>
        </ol>
      </nav>

      <!-- CABECERA COMPLETA DE EVENTOS -->
<div class="header-wrapper">
  <div class="category-header mb-4">
    <img src="assets/images/eventos/miscelanea.png" alt="Cabecera eventos" class="header-image" />
    <h1>
  {{ tipoSeleccionado ? nombreCategoriaSeleccionada : 'Eventos' }}
</h1>

  </div>
</div>


<!-- FILTROS + BOTÃ“N VER TODOS -->
<form class="row g-3 align-items-end filtros-form">
  <!-- Tipo de evento -->
  <div class="col-md-3">
    <label class="form-label">Tipo de evento:</label>
    <select [(ngModel)]="tipoSeleccionado"
            name="tipoSeleccionado"
            class="form-select"
            (ngModelChange)="filtrarEventos()">
      <option value="">Todos</option>
      <option *ngFor="let categoria of categorias" [value]="categoria.tipo">
        {{ categoria.nombre }}
      </option>
    </select>
  </div>

  <!-- Â¿Es gratuito? -->
  <div class="col-md-3">
    <label class="form-label">Â¿Es gratuito?</label>
    <select [(ngModel)]="esDePagoSeleccionado"
            name="esDePagoSeleccionado"
            class="form-select"
            (ngModelChange)="filtrarEventos()">
      <option value="todos">Todos</option>
      <option value="false">SÃ­</option>
      <option value="true">No</option>
    </select>
  </div>

  <!-- Checkbox destacados -->
  <div class="col-md-3">
    <div class="form-check">
      <input class="form-check-input"
             type="checkbox"
             [(ngModel)]="soloDestacados"
             name="soloDestacados"
             id="destacadosCheck"
             (change)="filtrarEventos()">
      <label class="form-check-label" for="destacadosCheck">Solo destacados â­</label>
    </div>
  </div>

  <!-- BotÃ³n Ver todos -->
  <div class="col-md-3">
    <button type="button" class="btn btn-verde w-100" (click)="verTodosEventos()">
      ğŸ”„ Ver todos
    </button>
  </div>
</form>

<!-- BOTÃ“N CREAR EVENTO DESTACADO -->
<div class="text-center mt-4">
  <ng-container *ngIf="isLoggedIn; else debeIniciarSesion">
    <button class="btn btn-destacado" (click)="irACrearEvento()">
      ğŸ‰ Â¡Crear nuevo evento!
    </button>
  </ng-container>
  <ng-template #debeIniciarSesion>
    <div class="alert alert-warning d-inline-block px-4 py-2">
      ğŸ”’ <a routerLink="/registro">RegÃ­strate</a> o <a routerLink="/login">inicia sesiÃ³n</a> para crear un evento.
    </div>
  </ng-template>
</div>


      <!-- ğŸ“Œ Eventos destacados -->
      <!-- ğŸ“Œ Eventos destacados (solo si no hay categorÃ­a seleccionada) -->
<section *ngIf="eventosDestacados.length > 0 && !tipoSeleccionado" class="mt-5 mb-4">

        <h3 class="text-center mb-4">ğŸŒŸ Eventos Destacados</h3>
        <div class="row">
          <div *ngFor="let evento of eventosDestacados" class="col-md-6 col-lg-4 mb-4">
            <div class="card post-highlight">
              <img [src]="evento.imagenUrl.startsWith('http') ? evento.imagenUrl : '/' + evento.imagenUrl"
                   class="card-img-top" [alt]="evento.titulo" />
              <div class="card-body">
                <h5 class="card-title">{{ evento.titulo }}</h5>
                <p class="card-text">{{ evento.descripcion | slice:0:80 }}...</p>
                <p class="text-muted small">{{ evento.apuntados || 0 }} personas apuntadas</p>
                <button class="btn-apuntarme w-100" *ngIf="!evento.yaInscrito" (click)="apuntarse(evento)">
  ğŸ™‹ Apuntarme
</button>
<button class="btn-ya-inscrito w-100" *ngIf="evento.yaInscrito" disabled>
  âœ… Ya estÃ¡s inscrito
</button>

              </div>
            </div>
          </div>
        </div>
      </section>

     <!-- ğŸ“Œ CategorÃ­as visuales -->
<section class="mt-4" *ngIf="!tipoSeleccionado">
  <h3 class="text-center mb-4">ğŸ“‚ CategorÃ­as de eventos</h3>
  <div class="row">
    <div *ngFor="let categoria of categorias" class="col-md-6 col-lg-4 mb-4">
      <div class="card shadow-sm">
        <a [routerLink]="['/eventos']" [queryParams]="{ tipo: categoria.tipo }">
          <img [src]="categoria.imagen" class="card-img-top" [alt]="categoria.nombre" />
        </a>
        <div class="card-body">
          <h5 class="card-title">{{ categoria.nombre }}</h5>
          <p class="card-text">{{ categoria.descripcion }}</p>
          <a [routerLink]="['/eventos']" [queryParams]="{ tipo: categoria.tipo }" class="btn-accion">Ver eventos</a>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- ğŸ“Œ Eventos filtrados por categorÃ­a -->
<section *ngIf="tipoSeleccionado && eventos.length > 0" class="mt-5 mb-4">
  <h3 class="text-center mb-4">ğŸ“Œ {{ nombreCategoriaSeleccionada }}</h3>
  <div class="row">
   <div *ngFor="let evento of eventos.slice(0, 9)" class="col-md-6 col-lg-4 mb-4">

      <div class="card post-highlight">
        <img [src]="evento.imagenUrl.startsWith('http') ? evento.imagenUrl : '/' + evento.imagenUrl"
             class="card-img-top" [alt]="evento.titulo" />
        <div class="card-body">
          <h5 class="card-title">{{ evento.titulo }}</h5>
          <p class="card-text">{{ evento.descripcion | slice:0:80 }}...</p>
          <p class="text-muted small">{{ evento.apuntados || 0 }} personas apuntadas</p>

          <button class="btn-apuntarme w-100" *ngIf="!evento.yaInscrito" (click)="apuntarse(evento)">
            ğŸ™‹ Apuntarme
          </button>
          <button class="btn-ya-inscrito w-100" *ngIf="evento.yaInscrito" disabled>
            âœ… Ya estÃ¡s inscrito
          </button>

        </div>
      </div>
    </div>
  </div>
</section>


    </div>
  </div>
</div>
